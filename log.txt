INFO: Scrapy 2.6.1 started (bot: webber)
INFO: Versions: lxml 4.8.0.0, libxml2 2.9.12, cssselect 1.1.0, parsel 1.6.0, w3lib 1.22.0, Twisted 22.2.0, Python 3.10.4 (tags/v3.10.4:9d38120, Mar 23 2022, 23:13:41) [MSC v.1929 64 bit (AMD64)], pyOpenSSL 22.0.0 (OpenSSL 1.1.1n  15 Mar 2022), cryptography 36.0.2, Platform Windows-10-10.0.19044-SP0
INFO: Overridden settings:
{'BOT_NAME': 'webber',
 'LOG_FILE': 'log.txt',
 'LOG_FORMAT': '%(levelname)s: %(message)s',
 'NEWSPIDER_MODULE': 'webscraper.webscraper_package.spiders',
 'SPIDER_MODULES': ['webscraper.webscraper_package.spiders'],
 'USER_AGENT': ('Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) '
                'Gecko/20100101 Firefox/88.0',)}
DEBUG: Using reactor: twisted.internet.selectreactor.SelectReactor
INFO: Telnet Password: c11a59b7a23142a5
INFO: Enabled extensions:
['scrapy.extensions.corestats.CoreStats',
 'scrapy.extensions.telnet.TelnetConsole',
 'scrapy.extensions.logstats.LogStats']
INFO: Enabled downloader middlewares:
['scrapy.downloadermiddlewares.httpauth.HttpAuthMiddleware',
 'scrapy.downloadermiddlewares.downloadtimeout.DownloadTimeoutMiddleware',
 'scrapy.downloadermiddlewares.defaultheaders.DefaultHeadersMiddleware',
 'scrapy.downloadermiddlewares.useragent.UserAgentMiddleware',
 'scrapy.downloadermiddlewares.retry.RetryMiddleware',
 'scrapy.downloadermiddlewares.redirect.MetaRefreshMiddleware',
 'scrapy.downloadermiddlewares.httpcompression.HttpCompressionMiddleware',
 'scrapy.downloadermiddlewares.redirect.RedirectMiddleware',
 'scrapy.downloadermiddlewares.cookies.CookiesMiddleware',
 'scrapy.downloadermiddlewares.httpproxy.HttpProxyMiddleware',
 'scrapy.downloadermiddlewares.stats.DownloaderStats']
INFO: Enabled spider middlewares:
['scrapy.spidermiddlewares.httperror.HttpErrorMiddleware',
 'scrapy.spidermiddlewares.offsite.OffsiteMiddleware',
 'scrapy.spidermiddlewares.referer.RefererMiddleware',
 'scrapy.spidermiddlewares.urllength.UrlLengthMiddleware',
 'scrapy.spidermiddlewares.depth.DepthMiddleware']
INFO: Enabled item pipelines:
['webscraper.webscraper_package.pipelines.WebberPipeline']
INFO: Spider opened
INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
INFO: Telnet console listening on 127.0.0.1:6023
DEBUG: Attempting to acquire lock 2800296303712 on C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\tldextract\.suffix_cache/publicsuffix.org-tlds\de84b5ca2167d4c83e38fb162f2e8738.tldextract.json.lock
DEBUG: Lock 2800296303712 acquired on C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\tldextract\.suffix_cache/publicsuffix.org-tlds\de84b5ca2167d4c83e38fb162f2e8738.tldextract.json.lock
DEBUG: Attempting to acquire lock 2800296305056 on C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\tldextract\.suffix_cache/urls\62bf135d1c2f3d4db4228b9ecaf507a2.tldextract.json.lock
DEBUG: Lock 2800296305056 acquired on C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\tldextract\.suffix_cache/urls\62bf135d1c2f3d4db4228b9ecaf507a2.tldextract.json.lock
DEBUG: Attempting to release lock 2800296305056 on C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\tldextract\.suffix_cache/urls\62bf135d1c2f3d4db4228b9ecaf507a2.tldextract.json.lock
DEBUG: Lock 2800296305056 released on C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\tldextract\.suffix_cache/urls\62bf135d1c2f3d4db4228b9ecaf507a2.tldextract.json.lock
DEBUG: Attempting to release lock 2800296303712 on C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\tldextract\.suffix_cache/publicsuffix.org-tlds\de84b5ca2167d4c83e38fb162f2e8738.tldextract.json.lock
DEBUG: Lock 2800296303712 released on C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\tldextract\.suffix_cache/publicsuffix.org-tlds\de84b5ca2167d4c83e38fb162f2e8738.tldextract.json.lock
DEBUG: Crawled (200) <GET https://www.foodie.fi/stores/?query=S-market%20Grani> (referer: None)
DEBUG: Crawled (200) <GET https://www.foodie.fi/stores/?query=Prisma%20Olari> (referer: None)
DEBUG: Crawled (200) <GET https://www.foodie.fi/stores/?query=Prisma%20Sello> (referer: None)
DEBUG: Redirecting (302) to <GET https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59> from <GET https://www.foodie.fi/store/select_store/0563cf74f373b2250360e756060fdb59>
DEBUG: Redirecting (302) to <GET https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08> from <GET https://www.foodie.fi/store/select_store/6c6a1d4de1a6454f30a3a5c185e51c08>
DEBUG: Redirecting (302) to <GET https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f> from <GET https://www.foodie.fi/store/select_store/4644aceccccd7ab8787cdfa92eb0020f>
DEBUG: Crawled (200) <GET https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59> (referer: https://www.foodie.fi/stores/?query=Prisma%20Olari)
DEBUG: Crawled (200) <GET https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08> (referer: https://www.foodie.fi/stores/?query=S-market%20Grani)
DEBUG: Crawled (200) <GET https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f> (referer: https://www.foodie.fi/stores/?query=Prisma%20Sello)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Tomaattimurska> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Rasvaton%20Maito> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kermajuusto> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
WARNING: c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py:121: SAWarning: Dialect sqlite+pysqlite does *not* support Decimal objects natively, and SQLAlchemy must convert from floating point - rounding errors and other issues may occur. Please consider storing Decimal numbers as strings or integers on this platform for lossless storage.
  store.products.append(store_product)

DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=AppelsiinimehuSpagetti> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Maustamaton%20tofukuutio> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Ruisleip%C3%A4> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Broilerileike> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Ruokakerma> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Margariini> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Jauheliha> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Riisi> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Vihre%C3%A4%20Ryp%C3%A4le> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Vihre%C3%A4%20Ryp%C3%A4le> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Klementiini> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Omena> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Appelsiini> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Banaani> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Klementiini> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Omena> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=J%C3%A4%C3%A4salaatti> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Banaani> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kukkakaali> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Paprika> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Appelsiini> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Sipuli> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Porkkana> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Basilika> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Peruna> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
WARNING: c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py:219: SAWarning: New instance <StoreProduct at 0x28bffe76140> with identity key (<class 'webscraper.data_manager_package.sqlalchemy_classes.StoreProduct'>, (38, 6415713110344), None) conflicts with persistent instance <StoreProduct at 0x28bfff34400>
  self.data_manager.session.commit()

ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Porkkana> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\engine\base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\engine\default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
sqlite3.IntegrityError: UNIQUE constraint failed: store_products.store_id, store_products.product_ean

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 219, in process_product_search
    self.data_manager.session.commit()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1431, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 829, in commit
    self._prepare_impl()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 808, in _prepare_impl
    self.session.flush()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 3363, in flush
    self._flush(objects)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 3502, in _flush
    with util.safe_reraise():
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 3463, in _flush
    flush_context.execute()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 456, in execute
    rec.execute(self)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\unitofwork.py", line 630, in execute
    util.preloaded.orm_persistence.save_obj(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\persistence.py", line 245, in save_obj
    _emit_insert_statements(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\persistence.py", line 1097, in _emit_insert_statements
    c = connection._execute_20(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\engine\base.py", line 1631, in _execute_20
    return meth(self, args_10style, kwargs_10style, execution_options)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\sql\elements.py", line 326, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\engine\base.py", line 1498, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\engine\base.py", line 1862, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\engine\base.py", line 2043, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\util\compat.py", line 207, in raise_
    raise exception
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\engine\base.py", line 1799, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\engine\default.py", line 729, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.IntegrityError: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Basilika> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kurkku> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=AppelsiinimehuSpagetti> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Coca%20Cola> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kahvi> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Tomaatti> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Peruna> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Kurkku> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=AppelsiinimehuSpagetti> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 219, in process_product_search
    self.data_manager.session.commit()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1431, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 827, in commit
    self._assert_active(prepared_ok=True)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Coca%20Cola> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Ketsuppi> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Tomaattimurska> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Riisi> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Kahvi> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Tomaatti> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Ketsuppi> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Tomaattimurska> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Riisi> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Broilerileike> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Ruisleip%C3%A4> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kermajuusto> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Broilerileike> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Ruisleip%C3%A4> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 214, in process_product_search
    page.print_products(limit=self.limit, condensed=True)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\foodie_pageclasses.py", line 158, in print_products
    self.print_details_condensed(product=product)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\foodie_pageclasses.py", line 147, in print_details_condensed
    print(f"[Product]: {values['name'] : ^70} Price: {values['price'] : <10} Quantity: {values['quantity'] : <5}")
TypeError: unsupported format string passed to NoneType.__format__
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Maustamaton%20tofukuutio> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Rasvaton%20Maito> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Kermajuusto> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Ruokakerma> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Maustamaton%20tofukuutio> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 219, in process_product_search
    self.data_manager.session.commit()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1431, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 827, in commit
    self._assert_active(prepared_ok=True)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Rasvaton%20Maito> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Vihre%C3%A4%20Ryp%C3%A4le> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Klementiini> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Ruokakerma> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Jauheliha> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Vihre%C3%A4%20Ryp%C3%A4le> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Klementiini> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Margariini> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Jauheliha> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Appelsiini> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Margariini> (referer: https://www.foodie.fi/store/4644aceccccd7ab8787cdfa92eb0020f)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Banaani> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=J%C3%A4%C3%A4salaatti> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Appelsiini> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Paprika> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Banaani> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=J%C3%A4%C3%A4salaatti> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kukkakaali> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Basilika> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Paprika> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Kukkakaali> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Sipuli> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Basilika> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Peruna> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Sipuli> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Peruna> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kurkku> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Porkkana> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Omena> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Kurkku> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Coca%20Cola> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Tomaatti> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Porkkana> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Omena> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kahvi> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Tomaattimurska> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Coca%20Cola> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Tomaatti> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=AppelsiinimehuSpagetti> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Broilerileike> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Kahvi> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Tomaattimurska> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Ketsuppi> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Riisi> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=AppelsiinimehuSpagetti> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 219, in process_product_search
    self.data_manager.session.commit()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1431, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 827, in commit
    self._assert_active(prepared_ok=True)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Broilerileike> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Ketsuppi> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Riisi> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Ruisleip%C3%A4> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Ruokakerma> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Ruisleip%C3%A4> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Margariini> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Maustamaton%20tofukuutio> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Ruokakerma> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Rasvaton%20Maito> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Margariini> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Jauheliha> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Maustamaton%20tofukuutio> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 219, in process_product_search
    self.data_manager.session.commit()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1431, in commit
    self._transaction.commit(_to_root=self.future)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 827, in commit
    self._assert_active(prepared_ok=True)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Rasvaton%20Maito> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Jauheliha> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=J%C3%A4%C3%A4salaatti> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kukkakaali> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=J%C3%A4%C3%A4salaatti> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Porkkana> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Kukkakaali> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Porkkana> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Paprika> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Peruna> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Paprika> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Peruna> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Sipuli> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Sipuli> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kurkku> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Coca%20Cola> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Kurkku> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Coca%20Cola> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 214, in process_product_search
    page.print_products(limit=self.limit, condensed=True)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\foodie_pageclasses.py", line 158, in print_products
    self.print_details_condensed(product=product)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\foodie_pageclasses.py", line 147, in print_details_condensed
    print(f"[Product]: {values['name'] : ^70} Price: {values['price'] : <10} Quantity: {values['quantity'] : <5}")
TypeError: unsupported format string passed to NoneType.__format__
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Ketsuppi> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Ketsuppi> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kahvi> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Kahvi> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Basilika> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Basilika> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Kermajuusto> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
DEBUG: Crawled (200) <GET https://www.foodie.fi/products/search2?term=Tomaatti> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Kermajuusto> (referer: https://www.foodie.fi/store/6c6a1d4de1a6454f30a3a5c185e51c08)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
ERROR: Spider error processing <GET https://www.foodie.fi/products/search2?term=Tomaatti> (referer: https://www.foodie.fi/store/0563cf74f373b2250360e756060fdb59)
Traceback (most recent call last):
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\twisted\internet\defer.py", line 857, in _runCallbacks
    current.result = callback(  # type: ignore[misc]
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 57, in wrapper
    return callback(response, **kwargs)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 215, in process_product_search
    self.export_data(
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber.py", line 232, in export_data
    self.database_query(command=command, **payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\webscraper_package\spiders\webber_package\spider.py", line 28, in database_query
    result = func.execute()
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\commands.py", line 52, in execute
    self.receiver.add_product(**self.payload)
  File "c:\Users\Joke\Desktop\Webscraper\webscraper\data_manager_package\data_manager.py", line 113, in add_product
    .filter_by(name=payload["store_name"].lower()).all()[0]
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2768, in all
    return self._iter().all()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\query.py", line 2903, in _iter
    result = self.session.execute(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1691, in execute
    conn = self._connection_for_bind(bind)
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 1532, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 721, in _connection_for_bind
    self._assert_active()
  File "C:\Users\Joke\Desktop\Webscraper\webscraper-env\lib\site-packages\sqlalchemy\orm\session.py", line 601, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: store_products.store_id, store_products.product_ean
[SQL: INSERT INTO store_products (store_id, product_ean, price, unit_price, shelf_name, shelf_href) VALUES (?, ?, ?, ?, ?, ?)]
[parameters: ((38, 6430035370498, 1.59, '1.59€/kpl', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BS4,BS3,BS1,BS7,BM38,BU3,0590,BM34,BM31,BM32,BU4,BM37,BM39,BS6,0600,BU2,BM33,BS8,BS5,0595,BM36,0605,BM29,BM26,BU5,BM40,BM25,BM35,0580,BM28,BM30,0585,BS2,BM27&l=dep,sec2,zon'), (38, 6406300016057, 3.65, '14.60€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon'), (38, 6412000032532, 1.89, '6.30€/kg', 'Hyllyväli 47', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CH2,CH1,CH3,CH4,CH5&l=dep,sec2,zon'), (38, 6416054154004, 1.68, '8.40€/kg', 'HEDELMÄT JA VIHANNEKSET', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=0575,0570,0555,0565,0560&l=dep,sec2,zon'), (38, 6413467278402, 1.45, '4.83€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KF3,KF4,KF5,KF1,KF2,KF6&l=dep,sec2,zon'), (38, 6430104920500, 0.95, '4.75€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6415713110344, 1.19, '2.64€/kg', 'Hyllyväli 36', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=DF10,DF22,DE40,DF6,DE38,DF15,DF1,DF7,DF19,DE37,DF11,DF17,DF8,DF18,DF21,DE39,DF4,DF3,DF9,DF20,DF2,DF13,DF12,DF16,DF14,DF5&l=dep,sec2,zon'), (38, 6409730065343, 5.49, '12.20€/kg', 'Hyllyväli 49', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=CF8,CF5,CF4,CE19,CF2,CF6,CF7,CE20,CF1,CF9,CF10,CF3,CE18&l=dep,sec2,zon')  ... displaying 10 of 19 total bound parameter sets ...  (38, 6413467515408, 2.19, '6.64€/kg', 'LEIPÄ', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=KC7,KC10,KC11,KC9,KC12,KC8&l=dep,sec2,zon'), (38, 6420101885261, 3.79, '4.21€/kg', 'Hyllyväli 28', 'https://storemap.jupa.s-cloud.fi/indoor/v1/?apiKey=U2FsdGVkX19gB2t7Y60b9qjh4pr6bmBf7a8aNb16tRU%3D&s=512413972&f=1&hs=BA20,BA25,BA24,BA23,BA21,BA22,BA26,BA19&l=dep,sec2,zon'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
INFO: Closing spider (finished)
INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 41739,
 'downloader/request_count': 93,
 'downloader/request_method_count/GET': 93,
 'downloader/response_bytes': 4608038,
 'downloader/response_count': 93,
 'downloader/response_status_count/200': 90,
 'downloader/response_status_count/302': 3,
 'elapsed_time_seconds': 11.324097,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2022, 4, 25, 9, 10, 48, 481980),
 'httpcompression/response_bytes': 20832801,
 'httpcompression/response_count': 90,
 'log_count/DEBUG': 102,
 'log_count/ERROR': 59,
 'log_count/INFO': 10,
 'log_count/WARNING': 2,
 'request_depth_max': 2,
 'response_received_count': 90,
 'scheduler/dequeued': 93,
 'scheduler/dequeued/memory': 93,
 'scheduler/enqueued': 93,
 'scheduler/enqueued/memory': 93,
 'spider_exceptions/IntegrityError': 1,
 'spider_exceptions/PendingRollbackError': 56,
 'spider_exceptions/TypeError': 2,
 'start_time': datetime.datetime(2022, 4, 25, 9, 10, 37, 157883)}
INFO: Spider closed (finished)
